#include <vector>
#include <iostream>
#include <tuple>
#include <algorithm>


struct Segment {
    double length;
    bool sensing;
    bool downlink;
};

class Simulation {
public:
    Simulation(const std::vector<std::pair<double, double>>& sensing,
        const std::vector<std::pair<double, double>>& downlink)
        : sensing(sensing),
        downlink(downlink)
    {}

    // Рассчитывает производительность спутника при заданных скоростях съемки (uprate) и сброса (downrate)
    double capacity(double uprate, double downrate) const;

private:


    std::vector<std::pair<double, double>> sensing; // Набор интервалов съемки
    std::vector<std::pair<double, double>> downlink; // Набор интервалов сброса
};



double computeSegments(const std::vector<Segment> &segments, double uprate, double downrate) {
    double storage = 0.0;
    double transmitted = 0.0;
    for (const Segment &seg : segments) {
        if (seg.sensing) {
            const double gotin = seg.length*uprate;
            storage += gotin;
        }
        if (seg.downlink) {
            const double gotout = std::min(storage, seg.length*downrate);
            storage -= gotout;
            transmitted += gotout;
        }
    }
    return transmitted;
}

double Simulation::capacity(double uprate, double downrate) const {
    std::vector<std::pair<double, char>> sensing_points;
    std::vector<std::pair<double, char>> downlink_points;
    for (const auto &sns : sensing) {
        sensing_points.push_back({ sns.first, 's' });
        sensing_points.push_back({ sns.second, 's' });
    }
    for (const auto &dwn : downlink) {
        downlink_points.push_back({ dwn.first, 'd' });
        downlink_points.push_back({ dwn.second, 'd' });
    }
    std::vector<std::pair<double, char>> points(sensing_points.size() + downlink_points.size());
    std::merge(sensing_points.begin(), sensing_points.end(), 
               downlink_points.begin(), downlink_points.end(), 
               points.begin());
    
    if (points.size() < 2) {
        return 0.0;
    }
    
    std::vector<Segment> segments;
    std::pair<double, char> prev = points[0];
    bool in_sensing = (prev.second == 's');
    bool in_downlink = (prev.second == 'd');
    for (unsigned i = 1; i < points.size(); ++i) {
        const auto &cur = points[i];
        if (in_sensing || in_downlink) {
            segments.push_back({ cur.first - prev.first, in_sensing, in_downlink });
        }
        in_sensing ^= (cur.second == 's');
        in_downlink ^= (cur.second == 'd');
        prev = cur;
    }
    return computeSegments(segments, uprate, downrate);
}



#include <vector>
#include <iostream>
#include <tuple>

struct Diff {
    double abs;
    double rel;
};

Diff checkEq(double ac, double ex) {
    const double abs = std::abs(ac - ex);
    const double sum = std::abs(ex + ac);
    const double rel = sum > 0 ? std::abs(ac - ex) / std::abs(ex + ac) : abs;
    return { abs, rel };
}

struct CapacityInput {
    std::vector<std::pair<double, double>> sensing; // Интервалы съемки
    std::vector<std::pair<double, double>> downlink; // Интервалы сброса
    double uprate; // Скорость получения данных, бит/с
    double downrate; // Скорость передачи данных, бит/с
};

double capacityCalc(const CapacityInput& input) {
    Simulation sim(input.sensing, input.downlink);
    return sim.capacity(input.uprate, input.downrate);
}

void run_tests() {
    const std::vector<std::tuple<std::string, CapacityInput, double> > test_cases{
        {
            "Время:            0-----50----100---150---200-- \n"
            "Интервал съемки:  |------(.....)--------------- \n"
            "Интервал сброса:  |------------------[.....]--- \n",
            {
                { { 50, 100 } },
                { { 150, 200 } },
                1.0,
                1.0
            },
            50.0
        },
        {
            "Время:            0-----50----100---150---200-- \n"
            "Интервал съемки:  |------(.....)--------------- \n"
            "Интервал сброса:  |------------------[.....]--- \n",
            {
                { { 50, 100 } },
                { { 150, 200 } },
                2.0,
                1.0
            },
            50.0
        },
        {
            "Время:            0-----50----100---150---200-- \n"
            "Интервал съемки:  |------(.....)--------------- \n"
            "Интервал сброса:  |------------------[.....]--- \n",
            {
                { { 50, 100 } },
                { { 150, 200 } },
                1.0,
                2.0
            },
            50.0
        },
        {
            "Время:            0-----50----100---150---200-- \n"
            "Интервал съемки:  |------(.....)--------------- \n"
            "Интервал сброса:  |------------------[.....]--- \n",
            {
                { { 50, 100 } },
                { { 150, 200 } },
                2.0,
                2.0
            },
            100.0
        },
        {
            "Время:            0-----50----100---150---200-- \n"
            "Интервал съемки:  |------------------(.....)--- \n"
            "Интервал сброса:  |------[.....]--------------- \n",
            {
                { { 150, 200 } },
                { { 50, 100 } },
                1.0,
                1.0
            },
            0.0
        },
        {
            "Время:            0-----50----100---150---200-- \n"
            "Интервал съемки:  |------------(.....)--------- \n"
            "Интервал сброса:  |------[.....]--------------- \n",
            {
                { { 100, 150 } },
                { { 50, 100 } },
                1.0,
                1.0
            },
            0.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(...........)--------- \n"
            "Интервал сброса:  |------------[...........]--- \n",
            {
                { { 100, 200 } },
                { { 150, 250 } },
                1.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(...........)--------- \n"
            "Интервал сброса:  |------------[...........]--- \n",
            {
                { { 100, 200 } },
                { { 150, 250 } },
                2.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(...........)--------- \n"
            "Интервал сброса:  |------------[...........]--- \n",
            {
                { { 100, 200 } },
                { { 150, 250 } },
                1.0,
                2.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(...........)--------- \n"
            "Интервал сброса:  |------------[...........]--- \n",
            {
                { { 100, 200 } },
                { { 150, 250 } },
                2.0,
                2.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------------(...........)--- \n"
            "Интервал сброса:  |------[...........]--------- \n",
            {
                { { 150, 250 } },
                { { 100, 200 } },
                1.0,
                1.0
            },
            50.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------------(...........)--- \n"
            "Интервал сброса:  |------[...........]--------- \n",
            {
                { { 150, 250 } },
                { { 100, 200 } },
                1.0,
                2.0
            },
            50.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------------(...........)--- \n"
            "Интервал сброса:  |------[...........]--------- \n",
            {
                { { 150, 250 } },
                { { 100, 200 } },
                2.0,
                1.0
            },
            50.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------------(...........)--- \n"
            "Интервал сброса:  |------[...........]--------- \n",
            {
                { { 150, 250 } },
                { { 100, 200 } },
                2.0,
                2.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(.................)--- \n"
            "Интервал сброса:  |------[.................]--- \n",
            {
                { { 100, 250 } },
                { { 100, 250 } },
                1.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(.................)--- \n"
            "Интервал сброса:  |------[.................]--- \n",
            {
                { { 100, 250 } },
                { { 100, 250 } },
                10.0,
                10.0
            },
            1500.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(.................)--- \n"
            "Интервал сброса:  |------------[.....]--------- \n",
            {
                { { 100, 250 } },
                { { 150, 200 } },
                1.0,
                1.0
            },
            50.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(.................)--- \n"
            "Интервал сброса:  |------------[.....]--------- \n",
            {
                { { 100, 250 } },
                { { 150, 200 } },
                1.0,
                2.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(.................)--- \n"
            "Интервал сброса:  |------------[.....]--------- \n",
            {
                { { 100, 250 } },
                { { 150, 200 } },
                1.0,
                3.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------(.................)--- \n"
            "Интервал сброса:  |------------[.....]--------- \n",
            {
                { { 100, 250 } },
                { { 150, 200 } },
                2.0,
                1.0
            },
            50.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------------(.....)--------- \n"
            "Интервал сброса:  |------[.................]--- \n",
            {
                { { 150, 200 } },
                { { 100, 250 } },
                1.0,
                1.0
            },
            50.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------------(.....)--------- \n"
            "Интервал сброса:  |------[.................]--- \n",
            {
                { { 150, 200 } },
                { { 100, 250 } },
                2.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------------(.....)--------- \n"
            "Интервал сброса:  |------[.................]--- \n",
            {
                { { 150, 200 } },
                { { 100, 250 } },
                3.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250-- \n"
            "Интервал съемки:  |------------(.....)--------- \n"
            "Интервал сброса:  |------[.................]--- \n",
            {
                { { 150, 200 } },
                { { 100, 250 } },
                1.0,
                2.0
            },
            50.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.............................)--- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 350 } },
                { { 150, 200 }, { 250, 300 } },
                1.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.............................)--- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 350 } },
                { { 150, 200 }, { 250, 300 } },
                2.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.............................)--- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 350 } },
                { { 150, 200 }, { 250, 300 } },
                1.0,
                2.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.............................)--- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 350 } },
                { { 150, 200 }, { 250, 300 } },
                1.0,
                3.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.............................)--- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 350 } },
                { { 150, 200 }, { 250, 300 } },
                2.0,
                4.0
            },
            400.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.............................)--- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 350 } },
                { { 150, 200 }, { 250, 300 } },
                2.0,
                5.0
            },
            400.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.............................)--- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 350 } },
                { { 150, 200 }, { 250, 300 } },
                2.0,
                3.0
            },
            300.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(.....)--------- \n"
            "Интервал сброса:  |------[.............................]--- \n",
            {
                { { 150, 200 }, { 250, 300 } },
                { { 100, 350 } },
                1.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(.....)--------- \n"
            "Интервал сброса:  |------[.............................]--- \n",
            {
                { { 150, 200 }, { 250, 300 } },
                { { 100, 350 } },
                2.0,
                1.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(.....)--------- \n"
            "Интервал сброса:  |------[.............................]--- \n",
            {
                { { 150, 200 }, { 250, 300 } },
                { { 100, 350 } },
                6.0,
                2.0
            },
            400.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(.....)--------- \n"
            "Интервал сброса:  |------[.............................]--- \n",
            {
                { { 150, 200 }, { 250, 300 } },
                { { 100, 350 } },
                2.0,
                3.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(.....)--------- \n"
            "Интервал сброса:  |------[.......................]--------- \n",
            {
                { { 150, 200 }, { 250, 300 } },
                { { 100, 300 } },
                2.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.................)--------- \n"
            "Интервал сброса:  |------[...........]-----[...........]--- \n",
            {
                { { 150, 300 } },
                { { 100, 200 }, { 250, 350 } },
                1.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.................)--------- \n"
            "Интервал сброса:  |------[...........]-----[...........]--- \n",
            {
                { { 150, 300 } },
                { { 100, 200 }, { 250, 350 } },
                2.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.................)--------- \n"
            "Интервал сброса:  |------[...........]-----[...........]--- \n",
            {
                { { 150, 300 } },
                { { 100, 200 }, { 250, 350 } },
                3.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.................)--------- \n"
            "Интервал сброса:  |------[...........]-----[...........]--- \n",
            {
                { { 150, 300 } },
                { { 100, 200 }, { 250, 350 } },
                1.0,
                2.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(...........)-----(...........)--- \n"
            "Интервал сброса:  |------------[.................]--------- \n",
            {
                { { 100, 200 }, { 250, 350 } },
                { { 150, 300 } },
                1.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(...........)-----(...........)--- \n"
            "Интервал сброса:  |------------[.................]--------- \n",
            {
                { { 100, 200 }, { 250, 350 } },
                { { 150, 300 } },
                2.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(...........)-----(...........)--- \n"
            "Интервал сброса:  |------------[.................]--------- \n",
            {
                { { 100, 200 }, { 250, 350 } },
                { { 150, 300 } },
                1.0,
                2.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(...........)-----(.....)--------- \n"
            "Интервал сброса:  |------------[.......................]--- \n",
            {
                { { 100, 200 }, { 250, 300 } },
                { { 150, 350 } },
                1.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(...........)-----(.....)--------- \n"
            "Интервал сброса:  |------------[.......................]--- \n",
            {
                { { 100, 200 }, { 250, 300 } },
                { { 150, 350 } },
                2.0,
                1.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(...........)-----(.....)--------- \n"
            "Интервал сброса:  |------------[.......................]--- \n",
            {
                { { 100, 200 }, { 250, 300 } },
                { { 150, 350 } },
                3.0,
                1.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(...........)-----(.....)--------- \n"
            "Интервал сброса:  |------------[.......................]--- \n",
            {
                { { 100, 200 }, { 250, 300 } },
                { { 150, 350 } },
                1.0,
                2.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(...........)-----(.....)--- \n"
            "Интервал сброса:  |------[.......................]--------- \n",
            {
                { { 150, 250 }, { 300, 350 } },
                { { 100, 300 } },
                1.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(...........)-----(.....)--- \n"
            "Интервал сброса:  |------[.......................]--------- \n",
            {
                { { 150, 250 }, { 300, 350 } },
                { { 100, 300 } },
                2.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(...........)--- \n"
            "Интервал сброса:  |------[.......................]--------- \n",
            {
                { { 150, 200 }, { 250, 350 } },
                { { 100, 300 } },
                1.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(...........)--- \n"
            "Интервал сброса:  |------[.......................]--------- \n",
            {
                { { 150, 200 }, { 250, 350 } },
                { { 100, 300 } },
                2.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(...........)--- \n"
            "Интервал сброса:  |------[.......................]--------- \n",
            {
                { { 150, 200 }, { 250, 350 } },
                { { 100, 300 } },
                3.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.....)-----(...........)--- \n"
            "Интервал сброса:  |------[.......................]--------- \n",
            {
                { { 150, 200 }, { 250, 350 } },
                { { 100, 300 } },
                1.0,
                2.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.......................)--- \n"
            "Интервал сброса:  |------[...........]-----[.....]--------- \n",
            {
                { { 150, 350 } },
                { { 100, 200 }, { 250, 300 } },
                1.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.......................)--- \n"
            "Интервал сброса:  |------[...........]-----[.....]--------- \n",
            {
                { { 150, 350 } },
                { { 100, 200 }, { 250, 300 } },
                2.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.......................)--- \n"
            "Интервал сброса:  |------[...........]-----[.....]--------- \n",
            {
                { { 150, 350 } },
                { { 100, 200 }, { 250, 300 } },
                1.0,
                2.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------------(.......................)--- \n"
            "Интервал сброса:  |------[...........]-----[.....]--------- \n",
            {
                { { 150, 350 } },
                { { 100, 200 }, { 250, 300 } },
                2.0,
                3.0
            },
            250.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.......................)--------- \n"
            "Интервал сброса:  |------------[.....]-----[...........]--- \n",
            {
                { { 100, 300 } },
                { { 150, 200 }, { 250, 350 } },
                1.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.......................)--------- \n"
            "Интервал сброса:  |------------[.....]-----[...........]--- \n",
            {
                { { 100, 300 } },
                { { 150, 200 }, { 250, 350 } },
                2.0,
                1.0
            },
            150.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.......................)--------- \n"
            "Интервал сброса:  |------------[.....]-----[...........]--- \n",
            {
                { { 100, 300 } },
                { { 150, 200 }, { 250, 350 } },
                1.0,
                2.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.......................)--------- \n"
            "Интервал сброса:  |------------[.....]-----[...........]--- \n",
            {
                { { 100, 300 } },
                { { 150, 200 }, { 250, 350 } },
                2.0,
                3.0
            },
            400.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.......................)--------- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 300 } },
                { { 150, 200 }, { 250, 300 } },
                1.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.......................)--------- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 300 } },
                { { 150, 200 }, { 250, 300 } },
                2.0,
                1.0
            },
            100.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.......................)--------- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 300 } },
                { { 150, 200 }, { 250, 300 } },
                1.0,
                2.0
            },
            200.0
        },
        {
            "Время:            0-----100---150---200---250---300---350-- \n"
            "Интервал съемки:  |------(.......................)--------- \n"
            "Интервал сброса:  |------------[.....]-----[.....]--------- \n",
            {
                { { 100, 300 } },
                { { 150, 200 }, { 250, 300 } },
                2.0,
                3.0
            },
            300.0
        }
    };
    int failCount = 0;

    for (const auto& tuple : test_cases) {
        const auto [description, input, expected] = tuple;
        const double actual = capacityCalc(input);
        const Diff d = checkEq(actual, expected);
        if (d.rel < 1e-12) {
            std::cout << "PASSED\n";
        }
        else {
            ++failCount;
            std::cout << "NOT PASSED\n";
            std::cout << description << "uprate: " << input.uprate << "\ndownrate: " << input.downrate << "\n";
            std::cout << "Expected: " << expected << "\nActual:" << actual << "\n";
            std::cout << "rel: " << d.rel << ", abs: " << d.abs << "\n";
        }
    }
    if (failCount > 0) {
        std::cout << failCount << " tests failed" << std::endl;
    }
    else {
        std::cout << "\n\nAll tests PASSED" << std::endl;
    }
}

int main()
{
    run_tests();
    return 0;
}

